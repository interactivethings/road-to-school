<!DOCTYPE html>
<meta charset="utf-8">
<style>
body { 
  margin: 0; 
}
svg 
{
  position: absolute;
  top: 0;
  left: 0;
}
rect { 
  fill: transparent; 
}
canvas {
  position: absolute;
}

</style>
<body>
  <div id="static"></div>
  <div id="Dynamic"></div>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script>
  var map = {};
  map.width = 1080;
  map.height = 500;
  var factor = 1000;
  var nStatic = 1/3 * factor;
  var nDynamic = 2/3 * factor;

  map.canvasStatic =
    d3.select('#static')
      .append('canvas')
      .attr('id', "canvasStatic")
      .attr('width', map.width)
      .attr('height', map.height)
      .node().getContext('2d');

  map.canvasDynamic =
    d3.select('#Dynamic')
      .append('canvas')
      .attr('id', "canvasDynamic")
      .attr('width', map.width)
      .attr('height', map.height)
      .node().getContext('2d');

  map.svg =
    d3.select('body')
      .append('svg')
        .attr('width', map.width )
        .attr('height', map.height + 100)
        .append('g');

  map.svg.append('rect')
    .attr('class', 'overlay')
    .attr('width', map.width)
    .attr('height', map.height);


  map.canvasStatic.nodes = d3.range(nStatic).map(function() {
    var x = map.width * Math.random(),
        y =  10*Math.random();
    return { 
      x: x, 
      y: y 
    }
  });

  map.canvasDynamic.nodes = createNodes(nDynamic);

  var simulation = d3.forceSimulation(map.canvasDynamic.nodes)
      .alphaTarget(0.9)
      .velocityDecay(0.5)
      .force("Y", d3.forceY().strength(-0.07));

  simulation.on("tick", draw);

  map.svg.append("text")
    .style("fill", "black")
    .style("font-family", "Helvetica Neue")
    .style("font-weight", "300")
    .style("font-size", "30")
    .style("text-anchor", "middle")
    .text("  syrian refugee children can't wait to go back to school tomorrow" )
    .attr("x", map.width/2)
    .attr("y", map.height + 50);

    map.svg.append("text")
    .attr("id","counter")
    .style("fill", "black")
    .style("font-family", "Helvetica Neue")
    .style("font-weight", "300")
    .style("font-size", "30")
    .style("text-anchor", "middle")
    .attr("x", map.width/2)
    .attr("y", map.height/2);
    

  function createNodes(nDynamic) {
      var nodes = d3.range(nDynamic).map(function() {
      var x = map.width * Math.random(),
            y =  10*Math.random();
        return { 
          x: x, 
          y: y 
        }
      });
      return nodes;
  }

  function draw() {
    map.canvasDynamic.clearRect(0, 0, map.width, map.height);
    map.canvasStatic.clearRect(0, 0, map.width, map.height);
    map.svg.selectAll("text.counter").remove();
    
    d3.select("#counter").text("this is a counter that makes things bounce off");    
    var box = d3.select("#counter").node().getBBox();

    for (var i = 0, node; i < nDynamic; ++i) { //drawing all Dynamic dots
      node = map.canvasDynamic.nodes[i];

      if ( node.y > map.height)
      { 
        node.fy =  node.y - Math.floor(15*Math.random());
        node.fx = node.x;
        map.canvasDynamic.nodes.push({ x : map.width * Math.random(), y :  10*Math.random()});
      }
      map.canvasDynamic.beginPath();
      map.canvasDynamic.arc(node.x,node.y, 3, 0, 2*Math.PI);
      map.canvasDynamic.fillStyle = '#3B6C73';
      map.canvasDynamic.fill();
    }

    for (var i = 0, node; i < nStatic; ++i) { //drawing all Static dots
      node = map.canvasStatic.nodes[i];
      map.canvasStatic.beginPath();
      map.canvasStatic.arc(node.x,node.y, 3, 0, 2*Math.PI);
      map.canvasDynamic.fillStyle = '#000';
      map.canvasStatic.fill();
    }
  }

  function counterReturn() {
    return Math.floor(Math.random()*100);
  }

  </script>
</body>